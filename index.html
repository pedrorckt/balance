<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GDG</title>
</head>
<body>

  <!-- <audio src="track.mp3" autoplay="autoplay" loop="loop"></audio> -->

  <style>body {margin: 0; padding: 0;}</style>

  <script src="three.js"></script>
  <script src="physi.js"></script>
  <script>

    Physijs.scripts.worker = "physijs_worker.js";
    Physijs.scripts.ammo = "ammo.js";

    var cube, stand, bar, ground, current = null, controls = null;

    var scene = new Physijs.Scene();
    scene.setGravity(new THREE.Vector3(0, -30, 0));

    var camera = new THREE.PerspectiveCamera(90, window.innerWidth/window.innerHeight, 0.1, 100);
    camera.position.set(0,50,50)
    scene.add(camera);

    var renderer = new THREE.WebGLRenderer();
    renderer.shadowMap.enabled = true;
    renderer.setClearColor( 0xd0d0d0 );
    renderer.setSize(window.innerWidth,window.innerHeight);

    document.body.appendChild(renderer.domElement);
    
    var geos = {};
    var mats = {};
    var meshs = {};
    
    // chao
    mats.ground = Physijs.createMaterial(
      new THREE.MeshBasicMaterial({
        color: 0x008888
      }),
      0.8, // friction
      0.3 // restitution
    );
    
    geos.ground = new THREE.CubeGeometry(50,1,50);
    meshs.ground = new Physijs.BoxMesh(
      geos.ground,
      mats.ground,
      0
    );
    meshs.ground.position.y = -0.5;
    meshs.ground.name = "ground";

    scene.add(meshs.ground);
    
    // suporte
    mats.stand = new Physijs.createMaterial(
      new THREE.MeshBasicMaterial({color: 0x900090}),
      {
        restitution: 0,
        friction: 1
      }
    );
    geos.stand = new THREE.CubeGeometry(5,10,5);
    meshs.stand = new Physijs.BoxMesh(geos.stand, mats.stand);
    meshs.stand.position.y = 5;
    scene.add(meshs.stand);
    
    // trave
    mats.cross = new Physijs.createMaterial(
      new THREE.MeshBasicMaterial({color: 0xbb8888}),
      {
        restitution: 0,
        friction: 1
      }
    );
    geos.cross = new THREE.CubeGeometry(50,3,3);
    meshs.cross = new Physijs.BoxMesh(geos.cross, mats.cross);
    meshs.cross.position.y = 12;
    scene.add(meshs.cross);

    camera.lookAt(new THREE.Vector3(0,0,0));

    var ambient = new THREE.AmbientLight(0x909090);
    scene.add(ambient);

    var spot = new THREE.SpotLight({color: 0x909090});
    spot.position.set(3, 3, 1);
    spot.castShadow = true;
    scene.add(spot);

    function render() {
      scene.simulate();
      renderer.render(scene, camera);
      requestAnimationFrame(render);
    }

    render();

  </script>

</body>
</html>
